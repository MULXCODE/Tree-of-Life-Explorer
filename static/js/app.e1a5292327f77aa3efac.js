webpackJsonp([1],{"+8J1":function(t,e){},"+q68":function(t,e){},"/fgt":function(t,e){},"/nkM":function(t,e){},"67t3":function(t,e){},"7AvW":function(t,e){},"8cCz":function(t,e){},DYRv:function(t,e){},DjAz:function(t,e){},KKL3:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("7+uW"),a=new i.default,o=n("/ocq"),s=n("bOdI"),r=n.n(s),c=n("Dd8w"),l=n.n(c),u={name:"Collage",props:{images:Array},data:function(){return{}},computed:{useCollage:function(){return this.images.length>3}},components:{},methods:{}},d={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"wrap"},[this.useCollage?this._e():e("div",{staticClass:"single"},[e("img",{attrs:{src:this.images[0]}})]),this.useCollage?e("div",{staticClass:"collage"},this._l(this.images,function(t){return e("div",{staticClass:"image"},[e("img",{attrs:{src:t}})])}),0):this._e()])},staticRenderFns:[]};var h=n("VU/8")(u,d,!1,function(t){n("+q68")},"data-v-9a078c34",null).exports,m={name:"LeafViewMenu",props:{commonName:String,flapStyle:Boolean,scientificName:String,shortScientificName:String,images:Array,truncateLength:{type:Number,default:10}},data:function(){return{}},computed:{backgroundStyle:function(){return this.images&&this.images.length?"url("+this.images[0]+")":""}},components:{Collage:h},methods:{}},p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"leaf-menu"},[t.flapStyle&&t.commonName?n("div",{staticClass:"flap-title"},[n("b-tooltip",{staticClass:"common-name",attrs:{label:t._f("titleCase")(t.commonName),type:"is-dark",active:t.commonName.length>t.truncateLength+5}},[n("div",{staticClass:"text"},[t._v(t._s(t._f("titleCase")(t.commonName)))])])],1):t._e(),t.flapStyle?n("div",{staticClass:"flap-title flap-title-bottom"},[n("b-tooltip",{staticClass:"scientific-name",attrs:{label:t._f("titleCase")(t.scientificName),type:"is-dark",active:t.scientificName.length>t.truncateLength+5||t.shortScientificName.length<t.scientificName.length}},[n("div",{staticClass:"text"},[t._v(t._s(t.shortScientificName))])])],1):t._e(),n("div",{staticClass:"toolbar primary"},[n("div",{staticClass:"button-overlay"},[t._t("default")],2),n("div",{staticClass:"background-image",class:{darken:!t.flapStyle}},[n("Collage",{attrs:{images:t.images}})],1),t.flapStyle?t._e():n("div",{staticClass:"toolbar-item"},[n("div",{staticClass:"toolbar-text names item-title"},[t.commonName?n("b-tooltip",{staticClass:"common-name",attrs:{label:t._f("titleCase")(t.commonName),type:"is-dark",active:t.commonName.length>t.truncateLength}},[t._v(t._s(t._f("truncate")(t._f("titleCase")(t.commonName),t.truncateLength)))]):t._e(),n("b-tooltip",{staticClass:"scientific-name",attrs:{label:t._f("titleCase")(t.scientificName),type:"is-dark",active:t.scientificName.length>t.truncateLength||t.shortScientificName.length<t.scientificName.length}},[t._v(t._s(t._f("truncate")(t.shortScientificName,t.truncateLength)))])],1)])])])},staticRenderFns:[]};var f=n("VU/8")(m,p,!1,function(t){n("nnjX")},"data-v-608a73d5",null).exports,g=n("Xxa5"),v=n.n(g),b=n("woOf"),_=n.n(b),w=n("Gu7T"),x=n.n(w),y=n("fZjL"),C=n.n(y),k=n("0Qa9"),N=n.n(k),T=n("gszD"),I=n.n(T),L=n("Q7hp"),E=n.n(L),S=n("zMR/"),O=n.n(S),z=n("NGEn"),j=n.n(z),$=n("hIkJ"),R=n.n($),A=n("YqDm"),F=n.n(A),M=n("BO1k"),P=n.n(M),q=n("mvHQ"),V=n.n(q);function D(t){return t.expires<Date.now()}var W=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e5,n={};return window.setInterval(function(){return function(t){var e=C()(t),n=!0,i=!1,a=void 0;try{for(var o,s=P()(e);!(n=(o=s.next()).done);n=!0){var r=o.value;D(t[r])&&delete t[r]}}catch(t){i=!0,a=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw a}}}(n)},1e4),function(){for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];var s=function(t){return V()(t)}(a),r=function(t,e){return t[e]}(n,s);return r&&!D(r)?N.a.resolve(r.result):N.a.resolve(t.apply(void 0,a)).then(function(t){return function(t,e,n,i){return t[e]={expires:Date.now()+i,result:n},n}(n,s,t,e)})}},U=n("Rhpv"),H=n.n(U),B=n("7pyE"),G=n.n(B),K=n("kbi+"),Y=n.n(K),X=n("KBYM"),J=n.n(X),Q=n("NmiR"),Z=n.n(Q),tt=n("Lrp7"),et=n.n(tt),nt=n("mtWM"),it=n.n(nt),at=it.a.create({baseURL:"https://api.opentreeoflife.org/v3",timeout:1e4,crossdomain:!0});var ot=W(function(t){var e;if(G()(t,"mrca"))return function(t){"string"==typeof t&&(t=t.match(/(ott[\d]+)/g));var e={node_ids:t};return N.a.resolve(at.post("/tree_of_life/mrca",e)).then(function(t){return t.data.mrca}).then(function(e){return N.a.all([N.a.map(t,ot),e.taxon?e.taxon:lt(e.node_id).then(function(t){return{name:""+t.join(" and ")}})]).spread(function(t,n){var i=function(t){var e=t.map(function(t){return[].concat(t.lineage)});e.forEach(function(t){return t.reverse()});var n=(e=J()(e,function(t){return t.length})).pop(),i=Z()(n,function(t,n){return et()(e,function(e){return e[n]&&e[n].node_id===t.node_id})});return i.pop(),i.reverse(),i}(t);return e.taxon=n,e.lineage=i,e})})}(t);var n="string"==typeof t?"node_id":"ott_id",i=(e={},r()(e,n,t),r()(e,"include_lineage",!0),e);return N.a.resolve(at.post("/tree_of_life/node_info",i)).then(function(t){return t.data}).tap(function(t){t.response_for_mrca_of_broken_taxon&&console.error("WARNING: Received response_for_mrca_of_broken_taxon from OTOL")})});function st(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e={names:H()(t)};return N.a.resolve(at.post("/tnrs/match_names",e)).then(function(t){return t.data.results})}var rt=W(function(t){return st(t).then(function(e){return Y()(e,{name:t})}).then(function(t){if(!t)throw new Error("Node not found");return t.matches[0].taxon.ott_id}).then(ot)}),ct=(W(function(t){var e={source_id:t};return N.a.resolve(at.post("/taxonomy/taxon_info",e)).then(function(t){return t.data.ott_id})}),W(function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=G()(t,"ott")||G()(t,"mrca")?"node_id":"ott_id",a=(e={},r()(e,i,t),r()(e,"format","arguson"),r()(e,"height_limit",n),e);return N.a.resolve(at.post("/tree_of_life/subtree",a)).then(function(t){return t.data.arguson.children||[]})})),lt=W(function(t){var e,n=G()(t,"ott")||G()(t,"mrca")?"node_id":"ott_id",i=(e={},r()(e,n,t),r()(e,"format","arguson"),r()(e,"height_limit",1),e);return N.a.resolve(at.post("/tree_of_life/subtree",i)).then(function(t){return t.data.arguson.descendant_name_list||[]})});function ut(t,e){if(!e.taxon)return null;var n=Y()(e.taxon.tax_sources,function(e){return G()(e,t)});return n?n.replace(t+":",""):null}var dt=n("pFYg"),ht=n.n(dt),mt=n("Vz3F"),pt=n("GMGH"),ft=n.n(pt),gt=n("WIDu"),vt=n.n(gt),bt=n("Kp45"),_t=n.n(bt),wt=["","en","eng"],xt=Object(mt.setupCache)({maxAge:9e5,key:function(t){return t.url+V()(t.params)},exclude:{query:!1}}),yt=it.a.create({baseURL:"https://api.gbif.org/v1",timeout:1e4,adapter:xt.adapter,crossdomain:!0,paramsSerializer:function(t){return function(t){var e="";return C()(t).forEach(function(n){var i="object"===ht()(t[n]),a=i&&t[n].length>=0;i||(e+=n+"="+t[n]+"&"),i&&a&&t[n].forEach(function(t){e+=n+"="+t+"&"})}),e?e.slice(0,-1):e}(t)}});function Ct(t){t.vernacularNames||(t.vernacularNames=[],t.vernacularName&&t.vernacularNames.push({vernacularName:t.vernacularName,language:"eng"}));var e=t.vernacularNames.filter(function(t){return!t.language||wt.indexOf(t.language)>-1});return e=e.map(_t()([function(t){return t.vernacularName},ft.a])),e=vt()(e).join(", "),l()({},t,{vernacularNameList:e})}function kt(t){return yt("/species/search",{params:{qField:"SCIENTIFIC",status:"ACCEPTED",dataset_key:"fab88965-e69d-4491-a04d-e3198b626e52",q:t}}).then(function(t){return t.data.results}).then(function(t){return t.map(Ct)})}var Nt=n("w9Mt"),Tt=n.n(Nt),It=n("swUc"),Lt=n.n(It),Et=n("k3HL"),St=n.n(Et),Ot=n("Dc7M"),zt=n.n(Ot),jt=n("L8MQ"),$t=n.n(jt),Rt=n("94Kh"),At=n.n(Rt),Ft=n("Zrlr"),Mt=n.n(Ft),Pt=n("wxAW"),qt=n.n(Pt),Vt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Mt()(this,t),this.delay=e,this.batchSize=n,this.count=0}return qt()(t,[{key:"schedule",value:function(t){var e=this;this.count++;var n=Math.floor(this.count/this.batchSize)*this.delay;return N.a.delay(n).tap(function(){return e.count--}).return(t)}}]),t}(),Dt=Object(mt.setupCache)({maxAge:9e5,exclude:{query:!1}}),Wt=it.a.create({baseURL:"https://query.wikidata.org",headers:{Accept:"application/sparql-results+json"},params:{},crossdomain:!0,timeout:1e4,adapter:Dt.adapter}),Ut=new Vt(200,3);function Ht(t){var e=t.ncbiId,n=t.name,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=i.limit,o=i.lang;if(!e&&!n)return N.a.resolve([]);if(!n)return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.limit,i='SELECT ?item ?itemLabel ?pic ?commonName WHERE {\n    ?item wdt:P685 "'+t+"\".\n    OPTIONAL { ?item wdt:P18 ?pic. }\n    OPTIONAL { ?item wdt:P1843 ?commonName FILTER (lang(?commonName) = '"+(e.lang||"en")+'\'). }\n    SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }\n  }\n  LIMIT '+(n||10);return N.a.resolve(Wt("sparql?query="+encodeURIComponent(i))).then(function(t){return t.data})}(e);if(!e)return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.limit,i='SELECT ?item ?itemLabel ?pic ?commonName WHERE {\n    ?item wdt:P225 "'+t+"\".\n    OPTIONAL { ?item wdt:P18 ?pic. }\n    OPTIONAL { ?item wdt:P1843 ?commonName FILTER (lang(?commonName) = '"+(e.lang||"en")+'\'). }\n    SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }\n  }\n  LIMIT '+(n||10);return N.a.resolve(Wt("sparql?query="+encodeURIComponent(i))).then(function(t){return t.data})}(n);var s='SELECT DISTINCT ?item ?itemLabel ?pic ?commonName WHERE {\n    { ?item wdt:P685 "'+e+'". }\n    UNION\n    { ?item wdt:P225 "'+n+"\". }\n    OPTIONAL { ?item wdt:P18 ?pic. }\n    OPTIONAL { ?item wdt:P1843 ?commonName FILTER (lang(?commonName) = '"+(o||"en")+'\'). }\n    SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }\n  }\n  LIMIT '+(a||10);return N.a.resolve(Wt("sparql?query="+encodeURIComponent(s))).then(function(t){return t.data})}Wt.interceptors.request.use(function(t){return Ut.schedule(t)}),Wt.interceptors.response.use(function(t){if(t.request.fromCache)return t;var e=t.data,n=e.head.vars,i=e.results;return t.data=i.bindings.map(function(t){return _()({itemId:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").match(/\/([A-z1-9]+$)/);return t&&t[1]||""}(t.item.value)},At()(Tt()(t,n),"value"))}),t.data=function(t){var e=["item","itemId","itemLabel"],n=Lt()(t,"itemId");return $t()(n).map(function(t){var n=Tt()(t[0],e);return St()(t,function(t,n){return C()(zt()(n,e)).forEach(function(e){t[e]=t[e]||[],t[e].indexOf(n[e])<0&&t[e].push(n[e])}),t},n)})}(t.data),t},function(t){return console.dir(t),N.a.reject(t)});var Bt=Object(mt.setupCache)({maxAge:9e5,key:function(t){return t.url+V()(t.params)},exclude:{query:!1}}),Gt=it.a.create({baseURL:"https://species.wikimedia.org/w",timeout:1e4,crossdomain:!0,adapter:Bt.adapter});function Kt(t){return t.map(function(t){var e=t.imageinfo[0];return e=At()(e,function(t){return"string"==typeof t?t.replace("http:","https:"):t}),{pageid:t.pageid,image:e}})}function Yt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e.limit,e.thumbSize),i={action:"query",prop:"imageinfo",generator:"search",gsrsearch:'File:"'+t+'" NOT map NOT atlas NOT lineage NOT svg NOT phylogram NOT cladogram NOT Destroy_this_mad_brute NOT Classification NOT Anatomical_Man',format:"json",origin:"*",iiprop:"url|size"};return n&&(i.iiurlwidth=n),N.a.resolve(Gt("api.php",{params:i})).then(function(t){return t.data}).then(function(t){return $t()(E()(t,"query.pages"))}).then(function(t){return t.filter(function(t){return t.title.match(/\.(gif|png|jpe?g|svg)$/)})}).then(function(t){return J()(t,"index")}).then(Kt)}var Xt=["https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/Homininae_el.png/200px-Homininae_el.png","https://upload.wikimedia.org/wikipedia/commons/thumb/b/b4/Hominini.ar.png/200px-Hominini.ar.png","https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/LA2-NSRW-1-0307.jpg/200px-LA2-NSRW-1-0307.jpg"],Jt={ott335582:{pic:"https://upload.wikimedia.org/wikipedia/commons/1/14/Soimese_Crocicodile.jpg",thumbnail:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/14/Soimese_Crocicodile.jpg/200px-Soimese_Crocicodile.jpg"},ott517942:{pic:"https://upload.wikimedia.org/wikipedia/commons/6/68/Abete_rosso_1.jpg",thumbnail:"https://upload.wikimedia.org/wikipedia/commons/thumb/6/68/Abete_rosso_1.jpg/180px-Abete_rosso_1.jpg"},ott568878:{pic:"https://upload.wikimedia.org/wikipedia/commons/5/53/Pink_striped_mini_phalaenopsis_orchid.jpg",thumbnail:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Pink_striped_mini_phalaenopsis_orchid.jpg/320px-Pink_striped_mini_phalaenopsis_orchid.jpg"},ott1007058:{pic:"https://upload.wikimedia.org/wikipedia/commons/2/2a/Thorny_Seahorse_with_Jockey_-_Hippocampus_jayakari.jpg",thumbnail:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Thorny_Seahorse_with_Jockey_-_Hippocampus_jayakari.jpg/320px-Thorny_Seahorse_with_Jockey_-_Hippocampus_jayakari.jpg"},ott352914:{pic:"https://upload.wikimedia.org/wikipedia/commons/b/b1/Fungi_city.jpg",thumbnail:"https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/Fungi_city.jpg/320px-Fungi_city.jpg"},ott698424:{pic:"https://upload.wikimedia.org/wikipedia/commons/5/5c/Killer_whales_%40_Ocean_Show_%288783294977%29.jpg",thumbnail:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Killer_whales_%40_Ocean_Show_%288783294977%29.jpg/320px-Killer_whales_%40_Ocean_Show_%288783294977%29.jpg"},ott186816:{pic:"https://upload.wikimedia.org/wikipedia/commons/9/94/Snake_King_Cobra.jpg",thumbnail:"https://upload.wikimedia.org/wikipedia/commons/thumb/9/94/Snake_King_Cobra.jpg/320px-Snake_King_Cobra.jpg"},ott417957:{pic:"https://upload.wikimedia.org/wikipedia/commons/1/13/Chimpanzee_%2813968481823%29.jpg",thumbnail:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/13/Chimpanzee_%2813968481823%29.jpg/284px-Chimpanzee_%2813968481823%29.jpg"},ott541924:{pic:"https://upload.wikimedia.org/wikipedia/commons/b/bb/2014-11-23_067_Elefant_%28Elephantidae%29_anagoria.JPG",thumbnail:"https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/2014-11-23_067_Elefant_%28Elephantidae%29_anagoria.JPG/320px-2014-11-23_067_Elefant_%28Elephantidae%29_anagoria.JPG"},ott770309:{pic:"https://cdn.minutelabs.io/tree-of-life-explorer/homo-sapiens.jpg",thumbnail:"http://cdn.minutelabs.io/tree-of-life-explorer/homo-sapiens.jpg"},ott770315:{pic:"https://cdn.minutelabs.io/tree-of-life-explorer/homo-sapiens.jpg",thumbnail:"http://cdn.minutelabs.io/tree-of-life-explorer/homo-sapiens.jpg"},ott563166:{pic:"https://upload.wikimedia.org/wikipedia/commons/d/dc/Felis_catus_02.jpg",thumbnail:"https://upload.wikimedia.org/wikipedia/commons/thumb/d/dc/Felis_catus_02.jpg/200px-Felis_catus_02.jpg"},ott763018:{pic:"https://upload.wikimedia.org/wikipedia/commons/2/2d/CloudedLeopard.jpg",thumbnail:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2d/CloudedLeopard.jpg/200px-CloudedLeopard.jpg"},ott532127:{pic:"https://upload.wikimedia.org/wikipedia/commons/c/c5/Snow_leoaprd_in_snow.jpg",thumbnail:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c5/Snow_leoaprd_in_snow.jpg/200px-Snow_leoaprd_in_snow.jpg"},ott78477:{pic:"https://cdn.minutelabs.io/tree-of-life-explorer/selachii.jpg",thumbnail:"http://cdn.minutelabs.io/tree-of-life-explorer/selachii.jpg"},ott1005907:{pic:"https://cdn.minutelabs.io/tree-of-life-explorer/carassius-auratus.jpg",thumbnail:"http://cdn.minutelabs.io/tree-of-life-explorer/carassius-auratus.jpg"},ott244265:{pic:"https://upload.wikimedia.org/wikipedia/commons/3/3b/Uganda-Kob.jpg",thumbnail:"https://upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Uganda-Kob.jpg/200px-Uganda-Kob.jpg"},ott802117:{pic:"https://cdn.minutelabs.io/tree-of-life-explorer/mollusca.jpg",thumbnail:"http://cdn.minutelabs.io/tree-of-life-explorer/mollusca.jpg"},ott510761:{pic:"https://cdn.minutelabs.io/tree-of-life-explorer/hippopotamus-amphibius.jpg",thumbnail:"http://cdn.minutelabs.io/tree-of-life-explorer/hippopotamus-amphibius.jpg"},ott510762:{pic:"https://cdn.minutelabs.io/tree-of-life-explorer/hippopotamus-amphibius.jpg",thumbnail:"http://cdn.minutelabs.io/tree-of-life-explorer/hippopotamus-amphibius.jpg"},ott490099:{pic:"https://cdn.minutelabs.io/tree-of-life-explorer/bos-taurus.jpg",thumbnail:"http://cdn.minutelabs.io/tree-of-life-explorer/bos-taurus.jpg"},ott312031:{pic:"https://cdn.minutelabs.io/tree-of-life-explorer/homininae.jpg",thumbnail:"http://cdn.minutelabs.io/tree-of-life-explorer/homininae.jpg"},ott417969:{pic:"https://cdn.minutelabs.io/tree-of-life-explorer/gorilla.jpg",thumbnail:"http://cdn.minutelabs.io/tree-of-life-explorer/gorilla.jpg"}},Qt={key:!1,nubKey:!1,nameKey:!1,taxonID:!1,sourceTaxonKey:!1,kingdom:!0,phylum:!0,kingdomKey:!1,phylumKey:!1,datasetKey:!1,constituentKey:!1,parentKey:!1,parent:!0,scientificName:!0,canonicalName:!0,vernacularName:!0,vernacularNames:!0,vernacularNameList:!0,authorship:!0,nameType:!1,rank:!0,origin:!1,taxonomicStatus:"status",nomenclaturalStatus:!1,remarks:!1,numDescendants:!0,lastCrawled:!1,lastInterpreted:!1,issues:!1,synonym:!1};function Zt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];return C()(e).reduce(function(n,i){var a=e[i];return a?(!0===a&&(a=i),n[a]=t[i],"string"==typeof n[a]&&(n[a]=n[a].toLowerCase()),n):n},{})}function te(t){var e={gbif:function(t){return function(t){return N.a.resolve(yt("/species/"+t)).then(function(t){return Ct(t.data)})}(t).then(function(t){return Zt(t,Qt)})}},n=[],i=N.a.map(C()(e),function(n){var i=ut(n,t);return i?e[n](i):null});return n.push(i),N.a.all(n).then(function(t){return I.a.apply(void 0,x()(t))}).then(function(t){return t.reduce(function(t,e){return l()({},t,e)},{})}).then(function(e){return function(t,e){return e.vernacularNameList&&e.vernacularNameList.length?e:t.taxon?kt(t.taxon.unique_name).then(function(t){return t[0]}).then(function(t){return Zt(t,Qt)}).then(function(t){return l()({},e,t)}):e}(t,e)})}function ee(t){return t&&t.map?t.map(function(t){return t.replace("http:","https:")}):t}function ne(t,e){var n=Jt[e.node_id];return n&&(t.pic=I()(ee([n.pic]),t.pic),t.thumbnail=I()(ee([n.thumbnail]),t.thumbnail)),t}function ie(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Ht({ncbiId:e,name:t}).then(function(e){var a=e&&e[0]||{};if(!1===i.images)return a;return(n&&"unranked"!==n&&"class"!==n?N.a.join(Yt(n+" "+t,{thumbSize:i.thumbSize}),Yt(t,{thumbSize:i.thumbSize}),function(t,e){return I()(t,e)}):Yt(t,{thumbSize:i.thumbSize})).then(function(t){return e=t,F()(e,function(t){return R()(Xt,E()(t,"image.thumburl"))>-1});var e}).then(function(t){var e=t.map(function(t){return E()(t,"image.url")}),n=t.map(function(t){return E()(t,"image.thumburl")});return a.pic=I()(e,i.getAllImages?a.pic:[]),a.thumbnail=I()(n),a})}).then(function(t){return t.pic=ee(t.pic),t.thumbnail=ee(t.thumbnail),t})}function ae(t){return 0===t.node_id.indexOf("mrca")}var oe=W(N.a.coroutine(v.a.mark(function t(e,n){var i,a;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.taxon){t.next=4;break}return t.next=3,se(e.node_id);case 3:e=t.sent;case 4:if(!ae(e)){t.next=7;break}return i=e.taxon.name.split(" and "),t.abrupt("return",N.a.map(i,function(t){return ie(t,null,e.taxon.rank,{getAllImages:!1,thumbSize:n.thumbSize,images:n.images})}).then(function(t){return O.a.apply(void 0,[{},e.taxon].concat(x()(t),[function(t,e){if(j()(t))return t.concat(e)}]))}));case 7:return a=ut("ncbi",e),t.abrupt("return",te(e).then(function(t){return ie(e.taxon.unique_name,a,e.taxon.rank,{getAllImages:!1,thumbSize:n.thumbSize,images:n.images}).then(function(n){return n=ne(n,e),_()({},e.taxon,t,n)})}));case 9:case"end":return t.stop()}},t,this)})));function se(t){return ot(t).then(function(t){return function(t){return l()({},t)}(t)})}var re=n("afSG"),ce=n.n(re);function le(t){var e=document.createElement("textarea");e.value=t,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}var ue={name:"TaxonomyInfoWindow",props:{leaf:Object,txnInfo:Object},data:function(){return{currentPic:0,swiperOptions:{navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination"}},isTouch:"ontouchstart"in document.documentElement}},computed:{commonName:function(){return this.isMRCA?"":this.txnInfo&&this.txnInfo.vernacularNameList?this.txnInfo.vernacularNameList:this.otherCommonNames?this.otherCommonNames[0]:""},scientificName:function(){return this.txnInfo&&(this.txnInfo.canonicalName||this.txnInfo.name||this.leaf.node_id)||""},isMRCA:function(){return this.leaf&&ae(this.leaf)},rankLink:function(){return"https://en.wikipedia.org/wiki/"+this.txnInfo.rank+"_(biology)"},links:function(){var t=ut("ncbi",this.leaf),e=ut("gbif",this.leaf);return ce()([{text:"Wikipedia",url:!this.isMRCA&&"https://en.wikipedia.org/wiki/"+this.scientificName,image:"https://3c1703fe8d.site.internapcdn.net/newman/gfx/news/hires/2017/58af0228b8aa8.jpg"},{text:"Open Tree of Life",url:"https://tree.opentreeoflife.org/opentree/argus/opentree@"+this.leaf.node_id,image:"https://avatars2.githubusercontent.com/u/1752618?s=400&v=4"},{text:"NCBI",url:!!t&&"https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Info&id="+t,image:"https://pbs.twimg.com/profile_images/759051827/26243_367877492480_367794192480_4194340_6124010_n_400x400.jpg"},{text:"GBIF",url:!!e&&"https://www.gbif.org/species/"+e,image:"https://pbs.twimg.com/profile_images/638655521218785280/XCFoWw5r.jpg"}],function(t){return t.url})}},components:{},methods:{nextImage:function(){var t=this.txnInfo.thumbnail.length;this.currentPic=(this.currentPic+1)%t},prevImage:function(){var t=this.txnInfo.thumbnail.length;this.currentPic=(this.currentPic-1+t)%t},copyToClipboard:function(t){this.$toast.open({message:"copied ID to clipboard",type:"is-info",position:"is-top-left"}),le(t)}}},de={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card"},[n("div",{staticClass:"card-content"},[n("div",{staticClass:"content"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-half"},[n("div",{staticClass:"otl-id"},[n("span",[t._v("OTL Id: "+t._s(t.leaf.node_id)+" ")]),n("a",{staticClass:"has-text-small",on:{click:function(e){return t.copyToClipboard(t.leaf.node_id)}}},[t._v("(copy)")])]),n("h1",{staticClass:"title has-text-dark"},[t._v(t._s(t.scientificName))]),t.commonName?n("h4",{staticClass:"subtitle"},[n("span",{staticClass:"has-text-grey"},[t._v("Commonly known as a ")]),n("span",{staticClass:"has-text-success"},[t._v(t._s(t.commonName))])]):t._e(),t.isMRCA?t._e():n("div",{staticClass:"tag-list"},[t.txnInfo.rank?n("div",{staticClass:"tags has-addons"},[n("span",{staticClass:"tag is-dark"},[t._v("Rank")]),n("a",{staticClass:"tag rank-tag",attrs:{href:t.rankLink,target:"_blank"}},[t._v(t._s(t.txnInfo.rank))])]):t._e(),t.txnInfo.numDescendants?n("div",{staticClass:"tags has-addons"},[n("span",{staticClass:"tag is-dark"},[t._v("Decendants")]),n("span",{staticClass:"tag is-info",attrs:{title:t.txnInfo.numDescendants}},[t._v(t._s(t._f("shortNumber")(t.txnInfo.numDescendants)))])]):t._e()]),t.isMRCA?n("b-message",{attrs:{type:"is-info"}},[t._v("This is an MRCA node")]):t._e()],1),t.txnInfo.thumbnail&&t.txnInfo.thumbnail.length?n("div",{staticClass:"column is-half"},[n("swiper",{staticClass:"info-window-swiper",attrs:{options:t.swiperOptions}},[t._l(t.txnInfo.thumbnail,function(t){return n("swiper-slide",{key:t},[n("div",{staticClass:"image-slide"},[n("img",{attrs:{src:t}})])])}),t.isTouch?t._e():n("div",{staticClass:"swiper-button-prev",attrs:{slot:"button-prev"},slot:"button-prev"},[n("b-icon",{attrs:{icon:"chevron-left"}})],1),t.isTouch?t._e():n("div",{staticClass:"swiper-button-next",attrs:{slot:"button-next"},slot:"button-next"},[n("b-icon",{attrs:{icon:"chevron-right"}})],1),n("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"})],2)],1):t._e()])]),n("div",{staticClass:"links"},[n("div",{staticClass:"is-size-5 heading"},[t._v("Find more information on...")]),n("div",{staticClass:"columns is-mobile is-multiline"},t._l(t.links,function(e){return n("div",{staticClass:"column is-one-quarter-tablet is-half-mobile"},[n("a",{attrs:{href:e.url,target:"_blank"}},[n("div",{staticClass:"card clickable"},[n("div",{staticClass:"card-image"},[n("figure",{staticClass:"image"},[n("img",{attrs:{src:e.image}})])]),n("div",{staticClass:"card-content"},[n("div",{staticClass:"content has-text-centered"},[t._v(t._s(e.text))])])])])])}),0)])])])},staticRenderFns:[]};var he=n("VU/8")(ue,de,!1,function(t){n("/nkM")},"data-v-696249e7",null).exports;function me(t,e){for(var n=t.split(" "),i=t,a=0;i.length>e&&a<n.length-1;){var o=n[a];n[a]=o[0]+".",i=n.join(" "),a++}return i}var pe={name:"TOLLeafView",props:["leaf","truncateLength","hideImages","flapStyle","horizontal"],components:{LeafViewMenu:f},filters:{shortName:me},data:function(){return{txnImages:[],otherCommonNames:[],pin:!1,expanded:!1,txnInfo:null,children:null,loading:!0,hovering:!1}},watch:{leaf:{handler:function(t){var e=this;t&&oe(t,{thumbSize:200}).then(function(t){if(e.txnInfo=t,e.otherCommonNames=t.commonName,t.thumbnail){var n=-1===["variety","species","subspecies"].indexOf(e.txnInfo.rank)?2:1;e.txnImages=t.thumbnail.slice(0,n)}else if(t.pic){var i=-1===["variety","species","subspecies"].indexOf(e.txnInfo.rank)?2:1;e.txnImages=t.pic.slice(0,i)}}).catch(function(t){return e.$emit("error",t)})},immediate:!0}},computed:{commonName:function(){return this.isMRCA?"":this.txnInfo&&this.txnInfo.vernacularNameList?this.txnInfo.vernacularNameList:this.otherCommonNames?this.otherCommonNames[0]:""},shortScientificName:function(){return me(this.scientificName,this.isMRCA?1e3:this.truncateLength)},scientificName:function(){return this.txnInfo&&(this.txnInfo.canonicalName||this.txnInfo.name||this.leaf.node_id)||""},isMRCA:function(){return this.leaf&&ae(this.leaf)},isAddedToTree:function(){return this.childIsAdded(this.leaf)}},methods:{childIsAdded:function(t){return!!this.$route.query.ids&&this.$route.query.ids.indexOf(t.node_id)>-1},getSubtree:function(){var t=this;this.children||(this.children=[],this.loading=!0,this.leaf?(this.active=!0,ct(this.leaf.node_id).then(function(e){t.children=t.children.concat(e),t.loading=!1}).catch(function(t){return console.error(t)})):this.active=!1)},openInfoWindow:function(){this.$modal.open({parent:this,component:he,props:{leaf:this.leaf,txnInfo:this.txnInfo},hasModalCard:!1})},show:function(){this.hovering=!0},hide:function(){this.hovering=!1},startTimer:function(t){var e=this;this.timer=setTimeout(function(){return e.hide()},t||200)},clearTimer:function(){clearTimeout(this.timer)},onTouch:function(t){this.hovering||(t.preventDefault(),t.stopImmediatePropagation()),this.clearTimer(),this.show(),this.startTimer(3e3)},onMouseLeave:function(t){this.startTimer()},onMouseEnter:function(t){var e=this;setTimeout(function(){return e.show()},50),this.clearTimer()}}},fe={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"item",class:{hovering:t.hovering,"flap-style":t.flapStyle,horizontal:t.horizontal,vertical:!t.horizontal},attrs:{"data-ott":t.leaf.node_id},on:{mousedown:function(t){t.stopPropagation()}}},[t.isAddedToTree?n("div",{staticClass:"card is-shadowless",on:{mouseleave:function(e){return e.stopPropagation(),e.preventDefault(),t.onMouseLeave(e)},mouseenter:function(e){return e.stopPropagation(),e.preventDefault(),t.onMouseEnter(e)},"!touchstart":function(e){return t.onTouch(e)}}},[n("div",{staticClass:"card-header is-shadowless"},[n("b-tooltip",{staticClass:"overlay-btn cut-btn",attrs:{label:"Remove this whole branch",type:"is-dark"}},[n("div",{staticClass:"btn",on:{click:function(e){return t.$emit("cut",t.leaf)}}},[n("b-icon",{attrs:{icon:"scissors-cutting",size:"is-medium"}}),n("b-icon",{staticClass:"trash",attrs:{icon:"close",size:"is-small"}})],1)]),n("b-tooltip",{staticClass:"overlay-btn descendants-btn",attrs:{slot:"front-button",label:"See descendants",type:"is-dark"},slot:"front-button"},[n("b-dropdown",{staticClass:"limit-dropdown",attrs:{"mobile-modal":!1},on:{"active-change":function(e){return t.getSubtree()}},nativeOn:{wheel:function(t){t.stopPropagation()}}},[n("b-icon",{attrs:{slot:"trigger",icon:"file-tree",size:"is-medium"},slot:"trigger"}),n("b-loading",{attrs:{"is-full-page":!1,active:t.loading}}),n("b-dropdown-item",{staticClass:"heading has-text-info"},[t._v("Descendants")]),t.children&&t.children.length?n("b-dropdown-item",[n("b-field",[n("div",{staticClass:"control"},[n("div",{staticClass:"button is-small",on:{click:function(e){t.$emit("add-node",t.children.map(function(t){return t.node_id}))}}},[n("b-icon",{attrs:{icon:"expand-all",size:"is-small"}}),n("span",[t._v("Expand All")])],1)]),n("div",{staticClass:"control"},[n("div",{staticClass:"button is-small",on:{click:function(e){t.$emit("remove-node",t.children.map(function(t){return t.node_id}))}}},[n("b-icon",{attrs:{icon:"collapse-all",size:"is-small"}}),n("span",[t._v("Remove All")])],1)])])],1):t._e(),n("hr",{staticClass:"dropdown-divider"}),t._l(t.children,function(e){return t.children&&t.children.length?n("b-dropdown-item",{key:e.node_id,class:{"has-text-grey-light":t.childIsAdded(e)},on:{click:function(n){return t.$emit("add-node",e.node_id)}}},[t._v(t._s(t._f("nodeName")(e)))]):t._e()}),t.loading||!t.children||t.children.length?t._e():n("b-dropdown-item",[t._v("None")])],2)],1),n("LeafViewMenu",{attrs:{"common-name":t.commonName,"scientific-name":t.scientificName,"flap-style":t.flapStyle,"short-scientific-name":t.shortScientificName,"truncate-length":t.commonName?t.truncateLength:2*t.truncateLength,images:t.hideImages?[]:t.txnImages}},[n("b-tooltip",{staticClass:"overlay-btn info-btn",attrs:{label:"More Information",type:"is-dark"}},[n("a",{staticClass:"toolbar-control",on:{click:function(e){t.hovering&&t.openInfoWindow()},touchstart:function(e){t.hovering&&t.openInfoWindow()}}},[n("b-icon",{attrs:{icon:"feature-search",size:"is-large"}})],1)]),n("b-tooltip",{staticClass:"overlay-btn remove-btn",attrs:{label:"Remove just this node",type:"is-dark"}},[n("a",{staticClass:"toolbar-control",on:{click:function(e){t.hovering&&t.$emit("remove",t.leaf.node_id)},touchstart:function(e){t.hovering&&t.$emit("remove",t.leaf.node_id)}}},[n("b-icon",{attrs:{icon:"close-network",size:"is-large"}})],1)])],1)],1)]):t._e(),t.isAddedToTree?t._e():n("div",{staticClass:"minimal",on:{click:function(e){return t.$emit("add-node",t.leaf.node_id)}}},[n("div",{staticClass:"card-title"},[t._v(t._s(t._f("titleCase")(t.commonName||t.shortScientificName)))])])])},staticRenderFns:[]};var ge=n("VU/8")(pe,fe,!1,function(t){n("TuVW")},"data-v-0d79f9ee",null).exports,ve={name:"TOLMRCAView",props:["leaf"],components:{},data:function(){return{leafData:null,txnInfo:null,loading:!0}},watch:{leaf:{handler:function(t){var e=this;t&&oe(t).then(function(t){e.txnInfo=t.txnInfo}).catch(function(t){return e.$emit("error",t)}).finally(function(){return e.loading=!1})},immediate:!0}},computed:{commonName:function(){return this.txnInfo?this.txnInfo.vernacularNameList:""},scientificName:function(){return this.txnInfo?this.txnInfo.canonicalName||this.leaf.taxon?this.leaf.taxon.name:this.leaf.node_id:""}},methods:{}},be={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mrca-item"},[n("div",{staticClass:"item-title"},[t.loading?n("span",[t._v("...")]):t._e(),t.loading?t._e():n("div",{staticClass:"names"},[n("div",{staticClass:"common-name"},[t._v(t._s(t._f("truncate")(t._f("capitalize")(t.commonName),24)))]),n("div",{staticClass:"scientific-name"},[t._v(t._s(t._f("truncate")(t._f("capitalize")(t.scientificName),24)))])])])])},staticRenderFns:[]};var _e=n("VU/8")(ve,be,!1,function(t){n("DYRv")},"data-v-4ac34044",null).exports;var we=n("VU/8")({name:"Node",inject:["svg"],props:["tree","x","y"],data:function(){return{}},mixins:[],beforeDestroy:function(){this.node.off("click"),this.node.remove()},beforeMount:function(){var t=this,e=this.svg;this.node=e.group().addClass("svg-node").move(0,0),this.node.rect(36,36).center(6,-6).radius(7),this.node.rect(36,36).center(3,-3).radius(7),this.node.rect(36,36).center(0,0).radius(7),this.label=this.node.plain(""+this.tree.lineage.length).attr("y",2),this.node.on("click",function(e){e.stopPropagation(),t.$emit("click",{subtree:t.tree,x:t.x,y:t.y})})},render:function(t){return this.node.data("ott",this.tree.leaf.node_id),this.node.style("transform","translate3d("+this.x+"px, "+this.y+"px, 0)").front(),this.label.plain(""+this.tree.lineage.length),this.node}},null,!1,function(t){n("/fgt")},null,null).exports,xe={name:"AncestorCollapse",inject:["svg"],props:["tree","x","y","horizontal"],data:function(){return{}},watch:{horizontal:"drawDots"},beforeDestroy:function(){this.node.off("click"),this.node.remove()},beforeMount:function(){var t=this,e=this.svg;this.node=e.group().addClass("svg-ancestor-collapse").move(0,0),this.node.rect(40,40).center(0,0).radius(7),this.dots=this.node.group(),this.drawDots(),this.label=this.node.plain(""+this.tree.lineage.length),this.node.on("click",function(e){e.stopPropagation(),t.$emit("click",{subtree:t.tree,x:t.x,y:t.y})})},methods:{drawDots:function(){this.dots.clear(),this.horizontal?(this.dots.circle(3).center(8,0),this.dots.circle(3).center(0,0),this.dots.circle(3).center(-8,0)):(this.dots.circle(3).center(0,8),this.dots.circle(3).center(0,0),this.dots.circle(3).center(0,-8))}},render:function(t){return this.node.data("ott",this.tree.leaf.node_id),this.horizontal?this.node.addClass("horizontal"):this.node.removeClass("horizontal"),this.node.style("transform","translate3d("+this.x+"px, "+this.y+"px, 0)").front(),this.horizontal?this.label.attr("x",0).attr("y",-14):this.label.attr("x",-10).attr("y",1.5),this.label.plain(""+this.tree.lineage.length),this.node}};var ye=n("VU/8")(xe,null,!1,function(t){n("7AvW")},null,null).exports,Ce={name:"CondensedNode",inject:["svg"],props:["leaf","x","y","horizontal"],data:function(){return{txnInfo:null,otherCommonNames:[],loading:!1}},watch:{leaf:{handler:function(t){var e=this;t&&oe(t,{images:!1}).then(function(t){e.txnInfo=t,e.otherCommonNames=t.commonName}).catch(function(t){return e.$emit("error",t)})},immediate:!0}},computed:{commonName:function(){return this.isMRCA?"":this.txnInfo&&this.txnInfo.vernacularNameList?this.txnInfo.vernacularNameList:this.otherCommonNames&&this.otherCommonNames[0]||""},scientificName:function(){return this.txnInfo&&(this.txnInfo.canonicalName||this.txnInfo.name||this.leaf.node_id)||""},isMRCA:function(){return this.leaf&&ae(this.leaf)}},beforeDestroy:function(){this.node.off("click"),this.node.remove()},beforeMount:function(){var t=this,e=this.svg;this.node=e.group().addClass("svg-condensed-node").move(0,0),this.node.circle(10).center(0,0),this.label=this.node.plain("..."),this.node.on("click",function(e){e.stopPropagation(),t.$emit("click",{leaf:t.leaf,x:t.x,y:t.y})})},render:function(t){return this.node.style("transform","translate3d("+this.x+"px, "+this.y+"px, 0)").front(),this.horizontal?this.label.removeClass("vertical"):this.label.addClass("vertical"),this.commonName?this.label.plain(""+this.commonName):this.label.plain("("+this.scientificName+")"),this.node}};var ke=n("VU/8")(Ce,null,!1,function(t){n("8cCz")},null,null).exports;var Ne=n("VU/8")({name:"Node",inject:["svg"],props:["leaf","x","y"],data:function(){return{}},beforeDestroy:function(){this.tail.off("click"),this.tail.remove()},beforeMount:function(){var t=this,e=this.svg;this.tail=e.group().addClass("svg-tail").move(this.x,this.y),this.tail.circle(30).center(0,0),this.tail.on("click",function(e){e.stopPropagation(),t.$emit("click",{tail:t.tail,leaf:t.leaf,x:t.x,y:t.y})})},render:function(t){return this.tail.move(this.x,this.y).front(),this.tail}},null,!1,function(t){n("KKL3")},null,null).exports;var Te=n("VU/8")({name:"Connection",inject:["svg"],props:["x1","y1","x2","y2","padding","horizontal"],data:function(){return{}},mixins:[],beforeDestroy:function(){this.node.remove()},beforeMount:function(){var t=this.svg;this.node=t.polyline([]).addClass("svg-connection")},render:function(t){return this.plot(),this.node},methods:{plot:function(){var t=this.padding,e=this.x1,n=this.y1,i=this.x2,a=this.y2,o=void 0;o=this.horizontal?[[e,n],[e+t,n],[e+t,a],[i,a]]:[[e,n],[e,n+t],[i,n+t],[i,a]],this.node.plot(o).back()}}},null,!1,function(t){n("DjAz")},null,null).exports,Ie={name:"ChildMenu",props:{leaf:Object,x:Number,y:Number},data:function(){return{children:[],loading:!1,active:!1}},watch:{leaf:function(){var t=this;this.children=[],this.loading=!0,this.leaf?(this.active=!0,ct(this.leaf.node_id).then(function(e){t.children=t.children.concat(e),t.loading=!1}).catch(function(t){return console.error(t)})):this.active=!1}}},Le={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"child-menu dropdown",class:{"is-active":t.active},style:{transform:"translate("+t.x+"px, "+t.y+"px)"}},[n("div",{staticClass:"dropdown-menu"},[n("div",{staticClass:"dropdown-content"},[n("b-loading",{attrs:{"is-full-page":!1,active:t.loading}}),n("div",{staticClass:"dropdown-item heading has-text-info"},[t._v("Children")]),n("div",{staticClass:"dropdown-divider"}),t._l(t.children,function(e){return t.children.length?n("a",{staticClass:"dropdown-item",on:{click:function(n){return t.$emit("select",e)}}},[t._v(t._s(e.taxon?e.taxon.name:e.node_id))]):t._e()}),t.loading||t.children.length?t._e():n("div",{staticClass:"dropdown-item"},[t._v("None")])],2)])])},staticRenderFns:[]};var Ee=n("VU/8")(Ie,Le,!1,function(t){n("sIyf")},"data-v-614f94a0",null).exports,Se=n("rCVp"),Oe=n.n(Se);function ze(t){var e=Array(t.depth).fill(0).map(function(t){return[]});return function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=i+e.nTips-1;return n[a][o]={tree:e,key:e.leaf?e.leaf.node_id:e.lineage[0].node_id+a,isRoot:0===a,hasSplit:!!e.split},e.split?(e.split.forEach(function(e,o){t(e,n,i,a+1),i+=2*e.nTips}),n):n}(t,e),e}var je={name:"Tree",props:{tree:Object,x:Number,y:Number,px:Number,py:Number,cardWidth:Number,cardHeight:Number,padding:Number,branchSpacing:Number,horizontal:Boolean,flapStyle:Boolean,"hide-images":Boolean,computedBranches:null,compactView:Boolean,transitions:{type:Boolean,default:!0}},data:function(){return{subtreeLeaf:null,childMenuX:0,childMenuY:0}},components:{Connection:Te,ChildMenu:Ee,Node:we,AncestorCollapse:ye,CondensedNode:ke,Tail:Ne,TOLLeafView:ge,TOLMRCAView:_e},created:function(){document.addEventListener("click",this.onDocumentClick)},destroyed:function(){document.removeEventListener("click",this.onDocumentClick)},computed:{branches:function(){var t=this.tree,e=this.x,n=this.y,i=function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=n.horizontal,r=n.cardHeight,c=.5*(s?r:n.cardWidth)+n.padding,u=-(e.nTips-1),d=n.branchSpacing,h=[];return h.push({tree:e,x:i,y:a,px:void 0===n.px?i:n.px,py:void 0===n.py?a:n.py,key:e.leaf.node_id||e.leaf,dx:s?c:0,dy:s?0:.75*r,isRoot:0===o,hasSplit:!!e.split.length}),e.split.length?h=h.concat(Oe()(e.split.map(function(e,h){var m,p,f=e.nTips-1;return s?(m=i+d+1.3*n.cardWidth,p=a+(f+u)*c):(m=i+(f+u)*c,p=a+d+1.3*r),u=2*f+u+2,t(e,l()({},n,{px:i,py:a}),m,p,o+1)}))):h}(t,{cardWidth:this.compactView?0:this.cardWidth,cardHeight:this.compactView?0:this.cardHeight,branchSpacing:this.compactView?40:this.branchSpacing,padding:this.compactView?10:this.padding,horizontal:this.horizontal},e,n);return this.$emit("update:computedBranches",i),i},columns:function(){return ze(this.tree)},truncateLength:function(){return this.cardWidth/9|0}},methods:{openChildMenu:function(t){var e=t.x,n=t.y,i=t.leaf;this.childMenuX=e,this.childMenuY=n,this.subtreeLeaf=i},onDocumentClick:function(){this.subtreeLeaf=null}}},$e={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tree"},[t.compactView?t._l(t.branches,function(e){return n("div",{staticClass:"tol-leaf",class:{horizontal:t.horizontal},style:{left:e.x+e.dx+"px",top:e.y+e.dy+"px"},attrs:{tabindex:-1}},[!e.isRoot||e.tree.lineage.length?n("Connection",{attrs:{horizontal:t.horizontal,x1:e.px,y1:e.py,x2:e.x+e.dx,y2:e.y+e.dy,padding:e.dx||e.dy}}):t._e(),e.tree.split.length?t._e():n("CondensedNode",{attrs:{leaf:e.tree.leaf,x:e.x+e.dx,y:e.y,horizontal:t.horizontal},on:{click:function(e){return t.$emit("zoom-in",arguments[0])}}})],1)}):t._e(),t.compactView?t._e():n("transition-group",{attrs:{name:"tree",css:t.transitions}},t._l(t.branches,function(e){return n("div",{key:e.key,staticClass:"tol-leaf",class:{horizontal:t.horizontal},style:{left:e.x-(t.horizontal?0:.5*t.cardWidth)+e.dx+"px",top:e.y-(t.horizontal?.5*t.cardHeight:0)+e.dy+"px",width:t.cardWidth+"px",height:t.cardHeight+"px"},attrs:{tabindex:-1,"data-ott":e.tree.leaf.node_id}},[!e.isRoot||e.tree.lineage.length?n("Connection",{attrs:{horizontal:t.horizontal,x1:e.px,y1:e.py,x2:e.x+e.dx,y2:e.y+e.dy,padding:1.7*(t.horizontal?t.cardWidth:t.cardHeight)}}):t._e(),e.tree.lineage.length?n("AncestorCollapse",{attrs:{tree:e.tree,x:e.x,y:e.y,horizontal:t.horizontal},on:{click:function(e){return t.$emit("leaf-click",arguments[0])}}}):t._e(),n("TOLLeafView",{attrs:{leaf:e.tree.leaf,"truncate-length":t.truncateLength,"hide-images":t.hideImages,"flap-style":t.flapStyle,horizontal:t.horizontal},on:{remove:function(n){return t.$emit("remove",e.tree.leaf)},cut:function(n){return t.$emit("cut",e.tree)},error:function(e){return t.$emit("error",arguments[0])},"add-node":function(e){return t.$emit("add-node",arguments[0])},"remove-node":function(e){return t.$emit("remove",arguments[0])}}})],1)}),0)],2)},staticRenderFns:[]};var Re=n("VU/8")(je,$e,!1,function(t){n("nYB+")},"data-v-720d7fba",null).exports,Ae=n("d7EF"),Fe=n.n(Ae),Me=n("or9x"),Pe=n.n(Me),qe=n("CbSA"),Ve=n.n(qe),De=n("pXIW"),We=n.n(De),Ue=n("O4Lo"),He=n.n(Ue);function Be(t,e,n){return Math.min(Math.max(t,e),n)}requestAnimationFrame(function t(e){requestAnimationFrame(t),We.a.update(e)});var Ge={name:"TreeCanvas",props:{width:{type:Number,default:0},height:{type:Number,default:0},offsetX:{type:Number,default:0},offsetY:{type:Number,default:0},panDuration:{type:Number,default:1e3}},data:function(){return{x:0,y:0,elWidth:0,elHeight:0}},provide:function(){return this.svgEl=document.createElement("svg"),this.svg=Pe()(this.svgEl).size("100%","100%").group(),{svg:this.svg}},mounted:function(){var t=this;this.$refs.svg.appendChild(this.svgEl.children[0]);var e=this.impetus=new Ve.a({source:this.$el,update:function(e,n){t.cancelPan(),t.setOffset(e,n)}}),n=He()(function(){t.onResize(),e.setBoundX(t.xBounds),e.setBoundY(t.yBounds)},200),i=function(n){if(t.$el.contains(n.target)){n.preventDefault();var i=t.getClampedCoords(t.x-n.deltaX,t.y-n.deltaY),a=i.x,o=i.y;return e.setValues(a,o),t.cancelPan(),t.setOffset(a,o),!1}},a=function(t){return t.stopPropagation()};window.addEventListener("wheel",i,!1),window.addEventListener("touchmove",a,{passive:!1}),this.$watch("width",n),this.$watch("height",n),window.addEventListener("resize",n),this.$once("hook:beforeDestroy",function(){window.removeEventListener("touchmove",a),window.removeEventListener("wheel",i),window.removeEventListener("resize",n),e.destroy()}),n()},watch:{top:"fixSVGPosition",left:"fixSVGPosition"},computed:{left:function(){return this.x+this.offsetX+.5*this.elWidth},top:function(){return this.y+this.offsetY+.5*this.elHeight},xBounds:function(){return[.5*-(this.width+this.elWidth),.5*(this.width+this.elWidth)]},yBounds:function(){return[.5*-(this.height+this.elHeight),.5*(this.height+this.elHeight)]}},methods:{fixSVGPosition:function(){var t=this.left,e=this.top;this.svg.move(t,e)},setOffset:function(t,e){this.x=t,this.y=e,a.$emit("tree:move")},getClampedCoords:function(t,e){var n=Fe()(this.xBounds,2),i=n[0],a=n[1],o=Fe()(this.yBounds,2),s=o[0],r=o[1];return{x:t=Be(t,i,a),y:e=Be(e,s,r)}},onResize:function(){this.elWidth=this.$el.offsetWidth,this.elHeight=this.$el.offsetHeight},panTo:function(t,e){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a={x:this.x,y:this.y};t=-t,e=-e;var o=this.getClampedCoords(t,e);if(t=o.x,e=o.y,this.cancelPan(),!i)return this.impetus.setValues(t,e),void this.setOffset(t,e);this._activeTween=new We.a.Tween(a).to({x:t,y:e},this.panDuration).easing(We.a.Easing.Quadratic.InOut).onUpdate(function(){n.impetus.setValues(a.x,a.y),n.setOffset(a.x,a.y)}).start()},cancelPan:function(){this._activeTween&&this._activeTween.stop()}}},Ke={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{ref:"wrapper",staticClass:"tree-canvas"},[e("div",{ref:"svg",staticClass:"svg"}),e("div",{staticClass:"slot",style:{transform:"translate3d("+this.left+"px, "+this.top+"px, 0)"}},[this._t("default")],2)])},staticRenderFns:[]};var Ye=n("VU/8")(Ge,Ke,!1,function(t){n("+8J1")},null,null).exports,Xe=n("rezj"),Je=n.n(Xe);function Qe(t){return{lineage:[].concat(t.lineage).reverse(),nTips:1,leaf:t,split:[]}}function Ze(t,e,n){return e=At()(e,Je.a),tn(t,Qe({node_id:t.lineage[n].node_id}),n),e.lineage.splice(0,n+1),t.nTips++,t.split.push(e),1}function tn(t,e,n){e=At()(e,Je.a);var i=t.lineage.splice(0,n),a=e.leaf;return t.lineage.shift(),e.lineage=t.lineage,e.split=t.split,e.nTips=t.nTips,e.leaf=t.leaf,t.lineage=i,t.split=[e],t.leaf=a,0}function en(t,e){for(var n=0,i=t.lineage.length;n<i;n++){var a=t.lineage[n],o=e.lineage[n];if(!o)return e.leaf.node_id===a.node_id?tn(t,e,n):Ze(t,e,n-1);if(a.node_id!==o.node_id)return Ze(t,e,n-1)}if(t.leaf.node_id===e.leaf.node_id)return t.leaf=e.leaf,0;if(e.lineage.length===t.lineage.length||t.lineage.length<e.lineage.length&&t.leaf.node_id!==e.lineage[t.lineage.length].node_id)return Ze(t,e,t.lineage.length-1);(e=At()(e,Je.a)).lineage.splice(0,t.lineage.length+1);var s=Y()(t.split,function(t){return function(t,e){return(t.lineage[0]?t.lineage[0].node_id:t.leaf.node_id)===(e.lineage[0]?e.lineage[0].node_id:e.leaf.node_id)}(t,e)});if(!s)return t.nTips++,t.split.push(e),1;var r=en(s,e);return t.nTips+=r,r}function nn(t){t.split&&(t.split.sort(function(t,e){return t.depth>e.depth?1:-1}),t.split.forEach(nn))}function an(t){for(var e=Qe((t=J()(t,function(t){return t.lineage.length}).reverse())[0]),n=1,i=t.length;n<i;n++)en(e,Qe(t[n]));return function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=void 0;return e.split?(e.leaf&&(n+=1),i=e.split.reduce(function(e,i){return Math.max(e,t(i,n))},n),e.depth=i,i):(i=n+1,e.depth=i,i)}(e),nn(e),e}var on=n("oU1d"),sn=n.n(on),rn={name:"TOLTree",props:["leafs","cardWidth","horizontal","hideImages","compactView","flapStyle"],components:{Tree:Re,TreeCanvas:Ye},data:function(){return{leafContext:null,openLeafContext:!1,leafContextX:0,leafContextY:0,padding:10,outerPadding:-80,canvasX:0,transitions:!0,branches:[]}},computed:{x:function(){return this.tree&&this.$el&&this.horizontal?-.5*this.width:0},y:function(){return this.tree&&this.$el?this.horizontal?0:-.5*this.height:0},branchSpacing:function(){return this.horizontal?160:80},cardHeight:function(){return this.flapStyle?110:90},width:function(){return this.tree?this.horizontal?2*this.outerPadding+this.tree.depth*(this.cardWidth+this.branchSpacing):2*this.outerPadding+this.tree.nTips*(this.cardWidth+2*this.padding):0},height:function(){return this.tree?this.horizontal?2*this.outerPadding+this.tree.nTips*(this.cardHeight+2*this.padding):2*this.outerPadding+this.tree.depth*(this.cardHeight+this.branchSpacing):0},tree:function(){return this.leafs&&this.leafs.length?an(this.leafs):null}},mounted:function(){var t=this;a.$on("tree:pan-to",function(e){return t.$nextTick(function(){return t.panTo(e)})})},beforeDestroy:function(){a.$off("tree:pan-to")},watch:{tree:function(t,e){var n=this;null===e&&this.$nextTick(function(){return n.centerTree()})},horizontal:function(){this.centerTree()},leafs:function(t,e){var n=this;if(e&&e.length){var i=sn()(t,e,"node_id");i.length&&this.$nextTick(function(){n.panTo(i[0].node_id)})}},compactView:function(){this.compactView&&this.centerTree()}},methods:{showLeafDetails:function(t){var e=30*t.subtree.lineage.length;this.openLeafContext=!0,this.leafContext=t,this.leafContextX=t.x+30,this.leafContextY=t.y-50+Math.max(0,50-e)},zoomTo:function(t){var e=this;this.$router.replace({query:l()({},this.$route.query,{c:!1})}),this.transitions=!1,this.$nextTick(function(){e.panTo(t),e.transitions=!0})},panTo:function(t){var e=Y()(this.branches,{key:t});e&&this.$refs.treeCanvas.panTo(e.x,e.y)},centerTree:function(){if(this.$refs.treeCanvas){var t=void 0,e=void 0;this.horizontal?(t=.5*(this.$el.clientWidth-this.width)-80,e=0):(t=0,e=.5*(this.$el.clientHeight-this.height)-80),this.$refs.treeCanvas.panTo(t,e,!1)}}}},cn={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"tree",appear:"appear"}},[t.tree?n("div",{staticClass:"tree",on:{click:function(e){t.openLeafContext=!1}}},[n("TreeCanvas",{ref:"treeCanvas",attrs:{width:t.width,height:t.height,"offset-x":0,"offset-y":0}},[t.openLeafContext?n("div",{staticClass:"parent-list limit-dropdown dropdown is-active",style:{top:t.leafContextY+"px",left:t.leafContextX+"px"},on:{wheel:function(t){t.stopPropagation()},touchstart:function(t){t.stopPropagation()}}},[n("div",{staticClass:"dropdown-menu"},[n("div",{staticClass:"dropdown-content"},[n("div",{staticClass:"dropdown-item heading has-text-info"},[t._v("Ancestors")]),t._l(t.leafContext.subtree.lineage,function(e){return n("a",{staticClass:"dropdown-item",class:{"has-text-grey":!e.taxon},on:{click:function(n){return t.$emit("add-node",e.node_id)}}},[t._v(t._s(t._f("nodeName")(e)))])})],2)])]):t._e(),n("Tree",{attrs:{tree:t.tree,x:t.x,y:t.y,compactView:t.compactView,cardWidth:t.cardWidth,cardHeight:t.cardHeight,horizontal:t.horizontal,"flap-style":t.flapStyle,"hide-images":t.hideImages,padding:t.padding,branchSpacing:t.branchSpacing,transitions:t.transitions,computedBranches:t.branches},on:{"update:computedBranches":function(e){t.branches=e},"update:computed-branches":function(e){t.branches=e},remove:function(e){return t.$emit("remove",arguments[0])},cut:function(e){return t.$emit("cut",arguments[0])},"leaf-click":t.showLeafDetails,"add-node":function(e){return t.$emit("add-node",arguments[0])},"zoom-in":function(e){return t.zoomTo(arguments[0].leaf.node_id)},error:function(e){return t.$emit("error",arguments[0])}}})],1)],1):t._e()])},staticRenderFns:[]};var ln=n("VU/8")(rn,cn,!1,function(t){n("RFeP")},"data-v-2b87e7ec",null).exports,un=n("VXg5"),dn=n.n(un),hn=n("mGzp"),mn=n.n(hn),pn=["MERGED","INCONSISTENT"];function fn(t){return st(t.map(function(t){return t.canonicalName||t.scientificName})).then(function(t){return F()(t,function(t){return mn()(t.matches[0].taxon.flags,function(t){return pn.indexOf(t)>-1})})}).then(function(t){return t.map(function(t){return t.name})}).then(function(e){return t.filter(function(t){return e.indexOf(t.canonicalName||t.scientificName)>-1})})}function gn(t){return dn()(t,"canonicalName")}function vn(t){return F()(t,function(t){return!t.vernacularNameList})}var bn={name:"TOLCommonNameSearch",props:["leaves"],components:{},data:function(){return{results:[],scientificResults:[],searchEntry:"",source:"gbif",isFetching:!1,isFetchingSci:!1,overlayOpen:!1}},methods:{openOverlay:function(){this.overlayOpen=!0,document.documentElement.style.overflow="hidden",this.$refs.overlayInput.focus()},closeOverlay:function(){this.overlayOpen=!1,document.documentElement.style.overflow=""},search:function(t){t=t.trim(),this.results=[],this.scientificResults=[],t&&(this.openOverlay(),this.isFetching=!0,this.isFetchingSci=!0,this.execSearch(t))},execSearch:He()(function(t){var e=this;("wikidata"!==this.source?this.searchGbif(t):this.searchWikidata(t)).then(function(t){e.results=t,e.isFetching=!1}).catch(function(t){e.errorMsg(t)}),this.searchGbif(t,!1).then(function(t){e.scientificResults=t,e.isFetchingSci=!1}).catch(function(t){e.errorMsg(t)})},500),searchGbif:W(function(t){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?function(t){return yt("/species/search",{params:{qField:"VERNACULAR",status:"ACCEPTED",dataset_key:"fab88965-e69d-4491-a04d-e3198b626e52",q:t}}).then(function(t){return t.data.results}).then(function(t){return t.map(Ct)})}(t).then(vn):kt(t)).then(gn).then(fn).then(function(t){return t.map(function(t){return{commonNames:t.vernacularNameList,scientificName:t.canonicalName||t.scientificName,rank:t.rank}})})}),searchWikidata:function(t){return function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).limit;if(!t)return N.a.resolve([]);var n='SELECT DISTINCT ?item ?scientificName ?pic ?commonName WHERE {\n    ?item wdt:P1843 ?commonName FILTER regex(?commonName, "'+t+'", "i").\n    { ?item wdt:P105 wd:Q7432. }\n    UNION\n    { ?item wdt:P105 wd:Q68947. }\n    ?item wdt:P225 ?scientificName.\n    OPTIONAL { ?item wdt:P18 ?pic. }\n    SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }\n  }\n  LIMIT '+(e||10);return N.a.resolve(Wt("sparql?query="+encodeURIComponent(n))).then(function(t){return t.data})}(t,{limit:10}).then(fn).then(function(t){return t.map(function(t){return{commonNames:t.commonName.join(", "),scientificName:t.scientificName.join(", "),rank:t.rank}})})},selectResult:function(t){var e=this;this.closeOverlay(),rt(t.scientificName).then(function(){return e.$emit("select",t)}).catch(function(t){return e.errorMsg(t)})},errorMsg:function(t){this.$toast.open({duration:5e3,message:"Error: "+t.message,type:"is-danger"})},clear:function(){this.searchEntry=""}}},_n={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"search",on:{keyup:function(e){return"keyCode"in e&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.closeOverlay(e)}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.overlayOpen,expression:"overlayOpen"}],staticClass:"overlay scrollbars",attrs:{tabindex:"-1"}},[n("div",{staticClass:"inner"},[n("div",{staticClass:"button is-outlined is-large close",on:{click:t.closeOverlay}},[n("b-icon",{attrs:{icon:"backburger",size:"is-medium"}})],1),n("b-field",[n("b-input",{ref:"overlayInput",attrs:{expanded:"expanded",size:"is-large",icon:"magnify",placeholder:"eg. Snow Leopard"},model:{value:t.searchEntry,callback:function(e){t.searchEntry=e},expression:"searchEntry"}}),n("span",{staticClass:"clear-btn delete is-large",on:{click:t.clear}})],1),n("div",{staticClass:"results"},[n("b-loading",{attrs:{active:t.isFetching||t.isFetchingSci,"is-full-page":!1}}),n("div",{staticClass:"columns"},[n("div",{staticClass:"column"},[n("aside",{staticClass:"menu"},[n("p",{staticClass:"menu-label"},[t._v("By Common Name...")]),n("ul",{staticClass:"menu-list"},t._l(t.results,function(e){return n("li",{staticClass:"item"},[n("a",{on:{click:function(n){return t.selectResult(e)}}},[n("span",{staticClass:"tag"},[t._v(t._s(e.rank||"?"))]),n("span",{staticClass:"common-names has-text-info"},[t._v(t._s(e.commonNames))]),n("span",{staticClass:"scientific-name"},[t._v("("+t._s(e.scientificName)+")")])])])}),0)])]),n("div",{staticClass:"column"},[n("aside",{staticClass:"menu"},[n("p",{staticClass:"menu-label"},[t._v("By Scientific Name...")]),n("ul",{staticClass:"menu-list"},t._l(t.scientificResults,function(e){return n("li",{staticClass:"item"},[n("a",{on:{click:function(n){return t.selectResult(e)}}},[n("span",{staticClass:"tag"},[t._v(t._s(e.rank||"?"))]),n("span",{staticClass:"common-names has-text-info"},[t._v(t._s(e.scientificName))]),n("span",{staticClass:"scientific-name"},[t._v(t._s(e.commonNames))])])])}),0)])])]),!t.searchEntry||t.isFetching||t.isFetchingSci||t.results.length||t.scientificResults.length?t._e():n("div",{staticClass:"empty-results-msg"},[t._v("No results. Is it spelled correctly?")])],1)],1)]),n("b-field",{attrs:{expanded:"expanded"}},[n("b-field",[n("b-input",{attrs:{type:"text",placeholder:"start typing...",icon:"magnify"},on:{input:t.search},nativeOn:{keyup:function(e){return t.openOverlay(e)}},model:{value:t.searchEntry,callback:function(e){t.searchEntry=e},expression:"searchEntry"}}),n("div",{staticClass:"control"},[n("div",{staticClass:"button",on:{click:t.openOverlay}},[n("span",[t._v("Search")])])])],1)],1)],1)},staticRenderFns:[]};var wn=n("VU/8")(bn,_n,!1,function(t){n("eOEL")},"data-v-23a4b036",null).exports,xn=[{title:"Darwin's Finches",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/a/ae/Darwin%27s_finches_by_Gould.jpg/440px-Darwin%27s_finches_by_Gould.jpg",desc:"Darwin's finches (also known as the Galápagos finches) are a group of about fifteen species of passerine birds. They are well known for their remarkable diversity in beak form and function. They are often classified as the subfamily Geospizinae or tribe Geospizini. &mdash; Wikipedia",ottIds:["ott589951","ott589956","ott5859950","ott589953","ott589955","ott589959","ott419376","ott419363","ott422530","ott419367","ott963505","ott527328","ott589949","ott527327","ott992256","ott589943"]},{title:'Our "Cousins"',image:"https://upload.wikimedia.org/wikipedia/commons/f/fb/Lightmatter_chimp.jpg",desc:"Species of Ape near Humans on the tree of life",ottIds:["ott417969","ott417957","ott770315","ott417949"]},{title:"Dinosaurs (and friends)",desc:"Dinosaurs, their desendants, and near cousins.",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/a/ab/Palais_de_la_Decouverte_Tyrannosaurus_rex_p1050042.jpg/320px-Palais_de_la_Decouverte_Tyrannosaurus_rex_p1050042.jpg",ottIds:["ott90215","ott81461","ott195672","ott195670","ott335582","ott639666","ott329823","ott35888","ott35887"]},{title:"Cats",desc:"The ones we keep as pets, and the... bigger ones",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7a/Two_littermates_cuddling_06.jpg/320px-Two_littermates_cuddling_06.jpg",ottIds:["ott763018","ott532127","ott563166","ott563159","ott886829","ott752759","ott42307","ott42314","ott563151","ott42324","ott42322"]},{title:"Peculiar Animals",image:"https://upload.wikimedia.org/wikipedia/commons/f/f6/AxolotlBE.jpg",desc:"A collection of strange looking animals.",ottIds:["ott984726","ott852676","ott679701","ott292504","ott1014156","ott71606","ott435643","ott721280","ott3632049","ott3652359","ott881015","ott464697","ott496400","ott50727","ott962377"]},{title:"Prehistoric Animals that Survived",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/b/b8/Cheeeeeese_....._%2826732940981%29.jpg/320px-Cheeeeeese_....._%2826732940981%29.jpg",desc:"A collection of animals that humans have found fossils of, and have survived the trials of natural selection to the present day.",ottIds:["ott73664","ott334633","ott801615","ott257929","ott754422","ott424193","ott511973","ott344064","ott35890","ott1093624","ott1084890","ott773491","ott3594707","ott616361","ott983579","ott962377","ott604022","ott316994","ott904117","ott469472","ott335582","ott397243","ott3617970"]},{title:"Eat your veggies",desc:"Closely related and good for you! Get to know your greens.",image:"https://commons.wikimedia.org/wiki/Special:FilePath/Broccoli%20and%20cross%20section%20edit.jpg",ottIds:["ott833618","ott472637","ott309288","ott833642","ott526294","ott181145","ott181153","ott209048","ott505210","ott833623","ott833629","ott833638","ott951624"]}],yn={name:"TOLSuggestedTrees",props:[],components:{},data:function(){return{suggestions:xn}},methods:{suggest:function(t){this.$emit("suggest",t)}}},Cn={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"suggested-trees"},[n("b-message",{attrs:{title:"Note",type:"is-danger","aria-close-label":"Dismiss"}},[t._v("The tree server is experiencing issues so the explorer may not function. This should be fixed soon so check back another time.")]),t._m(0),t._l(t.suggestions,function(e){return n("article",{staticClass:"suggestion clickable",on:{click:function(n){return t.suggest(e.ottIds)}}},[n("div",{staticClass:"container"},[n("div",{staticClass:"media"},[n("figure",{staticClass:"media-left"},[n("p",{staticClass:"image"},[n("img",{attrs:{src:e.image}})])]),n("div",{staticClass:"media-content"},[n("div",{staticClass:"content"},[n("p",{staticClass:"title"},[t._v(t._s(e.title))]),n("p",{domProps:{innerHTML:t._s(e.desc)}})])])])])])})],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"hero is-primary"},[e("div",{staticClass:"hero-body"},[e("div",{staticClass:"container"},[e("h2",{staticClass:"title"},[this._v("Welcome!")]),e("p",[this._v("Here's a list of curated trees for you to start from...")])])])])}]};var kn=n("VU/8")(yn,Cn,!1,function(t){n("wpAd")},"data-v-12e60ee5",null).exports,Nn=document.documentElement,Tn=Nn.requestFullscreen||Nn.webkitRequestFullscreen||Nn.mozRequestFullScreen||Nn.msRequestFullscreen;var In=function(){var t=!0,e=!1,n=void 0;try{for(var i,a=P()([["requestFullscreen","fullscreenchange"],["webkitRequestFullScreen","webkitfullscreenchange"],["mozRequestFullScreen","mozfullscreenchange"],["msRequestFullscreen","onmsfullscreenchange"]]);!(t=(i=a.next()).done);t=!0){var o=i.value;if(document.body[o[0]])return o[1]}}catch(t){e=!0,n=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw n}}return null}(),Ln=n("WlNK"),En=n.n(Ln),Sn=n("RyI1"),On=n.n(Sn),zn={name:"page-tol",props:{ids:{type:Array,default:function(){return[]}},wideMode:{type:Boolean,default:!1},horizontalMode:{type:Boolean,default:!0},hideImages:{type:Boolean,default:!1},compactView:{type:Boolean,default:!1},flapStyle:{type:Boolean,default:!1}},components:{TOLTree:ln,TOLCommonNameSearch:wn,TOLSuggestedTrees:kn},data:function(){return{leafs:[],canFullscreen:Tn,navOpen:!0,loading:!1,isInFullscreen:!1,tourMessage:!1}},created:function(){var t=this;In&&window.addEventListener(In,function(){t.isInFullscreen=!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)},{passive:!0})},computed:{cardWidth:function(){return this.wideMode?260:160},treeIsEmpty:function(){return!this.leafs.length}},watch:{ids:{handler:function(t,e){e&&e.length||(this.loading=!0),this.onIdsChanged(this.ids)},immediate:!0}},mounted:function(){var t=this;this.$el.offsetWidth<780&&setTimeout(function(){t.navOpen=!1},1e3),this.ids&&this.ids.length||setTimeout(function(){t.tourMessage=!0,t.$snackbar.open({message:"Hi there! If you would like me to show you around, click the tour button highlighted above!",position:"is-top-right",duration:1e4,type:"is-white",actionText:"go away"}),setTimeout(function(){t.tourMessage=!1},1e4)},2e3)},methods:{onError:function(t){console.error(t),this.showError(t)},showError:He()(function(t){var e="";e="Network Error"===t.message?"Trouble connecting with database! Sorry! Things might not work. Try refreshing...":t.message,this.$toast.open({message:e,type:"is-danger",duration:1e4,queue:!1})},100),undo:function(){this.$router.back()},redo:function(){this.$router.forward()},setLeafs:function(t){this.$router.push({query:l()({},this.$route.query,{ids:vt()(t)})})},addLeaf:function(t){t=H()(t),t=On()(t,function(t){return G()(t,"ott")||G()(t,"mrca")}),t=I()(t,this.ids),this.$router.push({query:l()({},this.$route.query,{ids:t})})},removeLeaf:function(t){this.$router.push({query:l()({},this.$route.query,{ids:En()(this.ids,H()(t))})})},onRemoveLeaf:function(t){this.removeLeaf(t.node_id||t)},onSelect:function(t){var e=this;rt(t.scientificName).then(function(t){e.addLeaf(t.node_id)}).catch(function(t){return e.onError(t)})},cutBranch:function(t){var e=function t(e){var n=e.split.length?e.split.reduce(function(e,n){return[].concat(x()(e),x()(t(n)))},[]):[];return[e.leaf].concat(n)}(t);this.removeLeaf(e.map(function(t){return t.node_id}))},addNode:function(t){return this.addLeaf(t)},onIdsChanged:function(t){var e=this;t&&N.a.map(t,se).then(function(t){return e.leafs=t}).catch(function(t){return e.onError(t)}).finally(function(){e.loading=!1})},clear:function(){this.$router.push({query:l()({},this.$route.query,{ids:[]})})},showMetaInfo:function(){this.$root.showMetaInfo=!0},menuToggle:function(){this.navOpen=!this.navOpen},fullscreenToggle:function(){var t;this.isInFullscreen?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen():(t=document.documentElement).requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen()},setOption:function(t,e){this.$router.replace({query:l()({},this.$route.query,r()({},t,0|e))})},share:function(){le(window.location),this.$toast.open({message:"URL copied to clipboard!",type:"is-success",position:"is-top-right"})},startTour:function(){a.$emit("tour:start")}}},jn={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app",class:{"nav-open":t.navOpen}},[n("nav",{staticClass:"top-nav box is-radiusless toolbar"},[n("div",{staticClass:"button menu-button",on:{click:t.menuToggle}},[n("b-icon",{attrs:{icon:t.navOpen?"chevron-up":"menu"}})],1),n("div",{staticClass:"toolbar-item"},[n("h1",{staticClass:"title main-title is-pulled-left clickable",on:{click:t.clear}},[t._v("Tree of Life Explorer")])]),n("div",{staticClass:"toolbar-item search-container"},[n("TOLCommonNameSearch",{staticClass:"search-box",on:{select:t.onSelect}})],1),n("div",{staticClass:"toolbar-right top-controls"},[n("b-field",{attrs:{grouped:"grouped"}},[n("b-field",[n("div",{staticClass:"control"},[n("b-tooltip",{attrs:{label:"Clear the tree",type:"is-dark",position:"is-bottom"}},[n("div",{staticClass:"button is-primary",on:{click:t.clear}},[n("b-icon",{attrs:{icon:"home"}})],1)])],1)]),n("b-field",[n("div",{staticClass:"control"},[n("b-tooltip",{attrs:{label:"Undo",type:"is-dark",position:"is-bottom"}},[n("div",{staticClass:"button",on:{click:t.undo}},[n("b-icon",{attrs:{icon:"undo"}})],1)])],1),n("div",{staticClass:"control"},[n("b-tooltip",{attrs:{label:"Redo",type:"is-dark",position:"is-bottom"}},[n("div",{staticClass:"button",on:{click:t.redo}},[n("b-icon",{attrs:{icon:"redo"}})],1)])],1)]),n("b-field",[n("b-dropdown",{staticClass:"options-dropdown",attrs:{"mobile-modal":!1}},[n("div",{staticClass:"button",attrs:{slot:"trigger"},slot:"trigger"},[n("span",[t._v("Options")]),n("b-icon",{attrs:{icon:"menu-down"}})],1),n("b-dropdown-item",{on:{click:function(e){return t.setOption("fs",!t.flapStyle)}}},[n("b-icon",{attrs:{icon:t.flapStyle?"checkbox-marked-circle":"checkbox-blank-circle-outline"}}),n("span",[t._v("Uncover Images")])],1),n("b-dropdown-item",{on:{click:function(e){return t.setOption("im",!t.hideImages)}}},[n("b-icon",{attrs:{icon:t.hideImages?"checkbox-marked-circle":"checkbox-blank-circle-outline"}}),n("span",[t._v("Hide Images")])],1),n("b-dropdown-item",{on:{click:function(e){return t.setOption("h",!t.horizontalMode)}}},[n("b-icon",{attrs:{icon:t.horizontalMode?"checkbox-marked-circle":"checkbox-blank-circle-outline"}}),n("span",[t._v("Horizontal Tree")])],1),n("b-dropdown-item",{on:{click:function(e){return t.setOption("w",!t.wideMode)}}},[n("b-icon",{attrs:{icon:t.wideMode?"checkbox-marked-circle":"checkbox-blank-circle-outline"}}),n("span",[t._v("Wide Cards")])],1)],1)],1),n("b-field",[n("div",{staticClass:"control"},[n("b-tooltip",{attrs:{label:"Share this tree",type:"is-dark",position:"is-bottom"}},[n("div",{staticClass:"button is-success",on:{click:t.share}},[n("b-icon",{attrs:{icon:"share"}})],1)])],1),n("div",{staticClass:"control"},[n("b-tooltip",{attrs:{label:"Take a helpful tour",type:"is-dark",position:"is-bottom","data-v-tour":"start"}},[n("div",{staticClass:"button is-dark",class:{pulsing:t.tourMessage},on:{click:t.startTour}},[n("b-icon",{attrs:{icon:"help-network"}})],1)])],1)])],1),n("div",{staticClass:"meta-info"},[n("a",{on:{click:t.showMetaInfo}},[t._v("About this app")])])],1)]),n("div",{staticClass:"below-nav"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.treeIsEmpty,expression:"!treeIsEmpty"}],staticClass:"tol-wrapper"},[n("TOLTree",{attrs:{leafs:t.leafs,"card-width":t.cardWidth,"hide-images":t.hideImages,compactView:t.compactView,horizontal:t.horizontalMode,"flap-style":t.flapStyle},on:{remove:t.onRemoveLeaf,cut:t.cutBranch,"add-node":t.addNode,error:t.onError}})],1),n("div",{staticClass:"wrapper"},[n("div",{staticClass:"inner"},[n("b-loading",{attrs:{"is-full-page":!1,active:t.loading}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.treeIsEmpty,expression:"treeIsEmpty"}],staticClass:"empty-state"},[n("div",{staticClass:"suggested"},[n("TOLSuggestedTrees",{on:{suggest:t.setLeafs}})],1)])],1)])]),n("div",{staticClass:"bottom-controls"},[n("b-field",[n("div",{staticClass:"control"},[n("b-tooltip",{attrs:{label:t.compactView?"Normal View":"Compact View",type:"is-dark",position:"is-left"}},[n("div",{staticClass:"button button-compact-view is-medium",on:{click:function(e){return t.setOption("c",!t.compactView)}}},[n("b-icon",{attrs:{icon:t.compactView?"magnify-plus":"magnify-minus"}})],1)])],1),t.canFullscreen?n("div",{staticClass:"control"},[n("b-tooltip",{attrs:{label:t.isInFullscreen?"Exit Fullscreen":"Enter Fullscreen",type:"is-dark",position:"is-left"}},[n("div",{staticClass:"button is-medium",on:{click:t.fullscreenToggle}},[n("b-icon",{attrs:{icon:t.isInFullscreen?"compress":"expand",pack:"fas"}})],1)])],1):t._e()])],1)])},staticRenderFns:[]};var $n=n("VU/8")(zn,jn,!1,function(t){n("d32Y")},"data-v-928ec8e6",null).exports,Rn=n("C2y9"),An=n.n(Rn);function Fn(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return!!parseInt(E()(t,e,n))}i.default.use(o.a);var Mn=new o.a({routes:[{path:"/",name:"index",component:$n,props:function(t){return{ids:An()(vt()(H()(t.query.ids))),wideMode:Fn(t.query,"w"),horizontalMode:Fn(t.query,"h",1),hideImages:Fn(t.query,"im"),compactView:Fn(t.query,"c"),flapStyle:Fn(t.query,"fs")}}}]}),Pn=n("+X65"),qn=n.n(Pn),Vn="ott563159",Dn=["ott532117","ott563166","ott770315",Vn],Wn=[{target:'[data-v-tour="start"]',content:"Welcome to the MinuteLabs.io Tree of Life Explorer! Let's show you around...",onEnter:function(){},params:{}},{target:'[data-v-tour="start"]',content:"Below is a tree that shows the connections between different species.",onEnter:function(t){"next"===t.type&&Mn.replace({query:{ids:Dn}})}},{target:'.tol-leaf[data-ott="ott563159"]',content:'This is a "clade node". It can represent any <a href="https://en.wikipedia.org/wiki/Taxonomic_rank" target="_blank">taxonomic rank</a> (species, family, genus, ...). In this case, it represents the Cat <em>Family</em>.',onEnter:function(){a.$emit("tree:pan-to",Vn)}},{target:'.tol-leaf[data-ott="ott563159"]',content:"The node shows the common name (if it has one), followed by the scientific name.",onEnter:function(){a.$emit("tree:pan-to",Vn)}},{target:'.tol-leaf[data-ott="ott563159"]',content:"Hovering (or tapping in touchscreens) will show buttons related to this node.",onEnter:function(){document.querySelector('.tol-leaf[data-ott="ott563159"]').classList.add("tour-hover")}},{target:'.tol-leaf[data-ott="ott563159"] .overlay-btn.descendants-btn',content:"This button will show the descendants (children) of this clade. There are a bunch for Cats!",params:{placement:"left"}},{target:'.tol-leaf[data-ott="ott563159"] .overlay-btn.cut-btn',content:"You can delete this whole branch of the tree by using this button.",params:{placement:"bottom"}},{target:'.tol-leaf[data-ott="ott563159"] .overlay-btn.info-btn',content:"You can see more information about the taxon with this button.",params:{placement:"bottom"}},{target:'.tol-leaf[data-ott="ott563159"] .overlay-btn.remove-btn',content:"This removes the card.",params:{placement:"bottom"},onLeave:function(){document.querySelector('.tol-leaf[data-ott="ott563159"]').classList.remove("tour-hover")}},{target:'.svg-ancestor-collapse[data-ott="ott563159"]',content:"This icon shows how many ancestors are between the Cat Family clade and the next node shown up the tree."},{target:".options-dropdown",content:"Use this button to control how the tree is displayed."},{target:".top-nav .search-box",content:'This will allow you to find clades and add them to the tree. You can search by their common name, or (if you know it) scientific name.<br/>Go ahead and give it a try by typing in something like "Blue Whale" or "Platypus"'}],Un={onStart:function(){this.execStepCallbacks(0,"start")},execStepCallbacks:function(t,e){var n=this.currentStep;if(n&&n.onLeave&&n.onLeave({type:e}),!(t<0)){var i=(n=this.currentStep=Wn[t]).onEnter;i&&i({type:e})}},onPreviousStep:function(t){this.execStepCallbacks(t-1,"back")},onNextStep:function(t){this.execStepCallbacks(t+1,"next")},onStop:function(){this.execStepCallbacks(-1,"stop")}},Hn={name:"App",data:function(){return{TourSteps:Wn,TourCallbacks:Un}},mounted:function(){var t=this;a.$on("tree:move",qn()(function(){var e=t.$tours.TOLTour.$children[0];e&&e.createStep()},500)),a.$on("tour:start",function(){t.$tours.TOLTour.start()})}},Bn={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[this._t("default"),this._v(" "),e("router-view"),this._v(" "),e("v-tour",{attrs:{name:"TOLTour",steps:this.TourSteps,callbacks:this.TourCallbacks}})],2)},staticRenderFns:[]};var Gn=n("VU/8")(Hn,Bn,!1,function(t){n("uNU+")},null,null).exports,Kn=n("lGpV"),Yn=n.n(Kn);function Xn(t){return t.split(" ").map(function(t){return Yn()(t)}).join(" ")}var Jn=[{range:[1,1e3],suffix:"",decimals:0},{range:[1e3,1e6],suffix:"k",decimals:1},{range:[1e6,1e9],suffix:"M",decimals:1},{range:[1e9,1/0],suffix:"B",decimals:1}];function Qn(t){if(0===t)return"0";var e=Y()(Jn,function(e){return e.range[0]&&t<e.range[1]});return(t/e.range[0]).toFixed(e.decimals)+e.suffix}function Zn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"...";return t.length<e?t:t.substr(0,e-n.length)+n}var ti={install:function(t,e){t.filter("capitalize",Yn.a),t.filter("titleCase",Xn),t.filter("filter",On.a),t.filter("shortNumber",Qn),t.filter("truncate",Zn),t.filter("nodeName",function(t){return t.taxon?t.taxon.name:t.descendant_name_list?t.descendant_name_list.join(" and "):t.node_id})}},ei=n("kFSY"),ni=n("pvO8"),ii=n.n(ni),ai=n("7QTg"),oi=n.n(ai),si=n("O3Oo"),ri=n.n(si);n("v2ns"),n("iq7p"),n("67t3");i.default.use(ri.a,{defaultContainerElement:"#app .below-nav"}),i.default.use(ti),i.default.use(ei.a),i.default.use(ii.a),i.default.use(oi.a),i.default.config.productionTip=!1;var ci,li,ui={props:["show"],template:(ci=document.getElementById("meta-info"),li=ci.innerHTML,ci.parentNode.removeChild(ci),li),computed:{showInfo:{get:function(){return this.show},set:function(t){this.$emit("update:show",t)}}}};new i.default({el:"#app",router:Mn,data:function(){return{showMetaInfo:!1}},components:{App:Gn,MetaInfoComponent:ui},template:'<App><MetaInfoComponent :show.sync="showMetaInfo"/></App>',computed:{}})},RFeP:function(t,e){},TuVW:function(t,e){},d32Y:function(t,e){},eOEL:function(t,e){},iq7p:function(t,e){},"nYB+":function(t,e){},nnjX:function(t,e){},sIyf:function(t,e){},"uNU+":function(t,e){},v2ns:function(t,e){},wpAd:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.e1a5292327f77aa3efac.js.map